%h1= @cloud_application.name

%p
  %b Blueprint:
  - if !@cloud_application.blueprint.nil?
    = link_to(@cloud_application.blueprint.name, @cloud_application.blueprint)

= markdown(@cloud_application.body)

%h2 Components
%ul
  - @cloud_application.concrete_components.each do |component|
    %li= link_to component.name, "#concrete_component_#{component.id}"
- @cloud_application.concrete_components.each do |component|
  %hr
  %section[component]
    %h1
      = component.name
      - if component.component
        %small
          (#{link_to(component.component.name, component.component)})
    = markdown(component.body)
    %h4 Target SLO's and Deployments
    - component.slo_sets.each do |slo_set|
      .row
        .col-md-6
          SLOs
          %ul
            - slo_set.humanize.each do |slo|
              %li= slo.capitalize
        .col-md-6
          - deployment = slo_set.deployment_recommendations.order("total_cost ASC").first
          - unless deployment.nil?
            Deployment recommendation
            %ul
              - if deployment.resource['type'] == 'compute'
                %li= pluralize(deployment.num_instances, "#{deployment.provider} #{deployment.resource_name} instance")
                  
              - else
                %li Provider: #{deployment.provider}
                %li Resource: #{deployment.resource_name}
                %li Number of instances:  #{deployment.num_instances}
              %li Total costs:  #{number_to_currency deployment.total_cost}
              %li Expected availability:  #{deployment.achieved_availability}





%p
.actions
  -#= link_to 'Show details', @cloud_application, class: 'btn btn-link'
  = link_to 'Edit', edit_cloud_application_path(@cloud_application), class: 'btn btn-warning'
  = link_to 'Find optimal deployments', recommendations_cloud_application_path(@cloud_application), method: :get, data: { confirm: 'Computing recommendations will take some time. Are you sure you want this?' }, class: 'btn btn-success'
  -#= link_to 'Monitor deployment', nil, class: 'btn btn-primary'
  = link_to 'Destroy', @cloud_application, :method => :delete, :data => { :confirm => 'Are you sure?' }, class: 'btn btn-danger'
  = link_to 'Back', cloud_applications_path, class: 'btn btn-link'